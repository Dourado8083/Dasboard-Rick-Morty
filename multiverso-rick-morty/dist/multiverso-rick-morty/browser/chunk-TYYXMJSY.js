import{c as n,i,ia as u,l as a}from"./chunk-DC7Z5ANC.js";var S=(()=>{class o{constructor(e){this.router=e;let t=localStorage.getItem("jwt_token");this.currentUserSubject=new n(t?this.getUserFromToken(t):null),this.currentUser=this.currentUserSubject.asObservable()}get currentUserValue(){return this.currentUserSubject.value}register(e,t,s){let r=this.getAllUsers();if(r.find(c=>c.email===t))return!1;let l={id:this.generateId(),name:e,email:t,password:btoa(s),hasProfile:!0};return r.push(l),localStorage.setItem("users",JSON.stringify(r)),!0}login(e){let s=this.getAllUsers().find(r=>r.email===e.email&&r.password===btoa(e.password));if(s){let r=btoa(JSON.stringify({id:s.id,name:s.name,email:s.email}));return localStorage.setItem("jwt_token",r),e.remember&&localStorage.setItem("remember_me","true"),this.currentUserSubject.next(s),!0}return!1}logout(){localStorage.removeItem("jwt_token"),localStorage.removeItem("remember_me"),this.currentUserSubject.next(null),this.router.navigate(["/login"])}isLoggedIn(){return!!localStorage.getItem("jwt_token")}hasProfile(){return this.isLoggedIn()}getCurrentUser(){let e=this.currentUserSubject.value;if(!e&&this.isLoggedIn()){let t=localStorage.getItem("jwt_token");t&&(e=this.getUserFromToken(t),this.currentUserSubject.next(e))}return e}getAllUsers(){let e=localStorage.getItem("users");return e?JSON.parse(e):[]}getUserFromToken(e){try{let t=JSON.parse(atob(e));return this.getAllUsers().find(r=>r.id===t.id)||null}catch{return null}}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static{this.\u0275fac=function(t){return new(t||o)(a(u))}}static{this.\u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{S as a};
